<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráficos - Bibliosfera</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div th:replace="~{fragments/navbar :: navbar}"></div>

<header class="border-bottom bg-light py-4">
      <div class="container">
          <div class="row align-items-center">
              <div class="col-lg-6 col-12 text-center text-lg-start mb-3 mb-lg-0">
                  <h2 class="text-primary display-5 fw-bold opacity-75">Graficos</h2>
                  <h4>"Las librerías son refugios donde habitan las historias."</h4>
              </div>
              <div class="col-lg-6 col-12 text-center">
                  <img th:src="@{/img/lib5.jpg}" class="img-fluid rounded shadow" alt="Librería">
              </div>
          </div>
      </div>
  </header>

<div class="container mt-4">
    <div class="row ">
        <div class="col-md-6">
            <h5>Libros por Género (Gráfico de Barras)</h5>
            <canvas id="barChart"></canvas>
        </div>
        <div class="col-md-6">
            <h5>Préstamos por Mes (Gráfico Lineal)</h5>
            <canvas id="lineChart"></canvas>
        </div>
    </div>
    <div class="row mt-4 align-items-center">
        <div class="col-md-6">
            <h5>Libros por Género (Gráfico de Círculo)</h5>
            <canvas id="pieChart"></canvas>
        </div>
    </div>
    <a href="/" class="btn btn-primary mt-4">Volver al Menú</a>
</div>
<script th:inline="javascript">
/*<![CDATA[*/
    let generos = /*[[${generos}]]*/ [];
    let librosPorGenero = /*[[${librosPorGenero}]]*/ [];
    let meses = /*[[${meses}]]*/ [];
    let prestamosPorMes = /*[[${prestamosPorMes}]]*/ [];
/*]]>*/
</script>

<script>
    // Gráfico de Barras
    new Chart(document.getElementById('barChart'), {
        type: 'bar',
        data: {
            labels: generos,
            datasets: [{
                label: 'Cantidad de Libros',
                data: librosPorGenero,
                backgroundColor: 'rgba(54, 162, 235, 0.6)'
            }]
        }
    });

    // Gráfico Lineal
    new Chart(document.getElementById('lineChart'), {
        type: 'line',
        data: {
            labels: meses,
            datasets: [{
                label: 'Préstamos',
                data: prestamosPorMes,
                borderColor: 'rgba(255, 99, 132, 0.8)',
                fill: false
            }]
        }
    });

    // Gráfico de Círculo
    new Chart(document.getElementById('pieChart'), {
        type: 'pie',
        data: {
            labels: generos,
            datasets: [{
                data: librosPorGenero,
                backgroundColor: [
                    'rgba(255, 99, 132, 0.6)',
                    'rgba(54, 162, 235, 0.6)',
                    'rgba(255, 206, 86, 0.6)',
                    'rgba(75, 192, 192, 0.6)'
                ]
            }]
        }
    });
</script>
<div th:replace="~{fragments/footer :: footer}"></div>


</body>
</html>